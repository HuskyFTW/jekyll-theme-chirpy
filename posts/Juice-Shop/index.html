<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Juice Shop Challenges" /><meta name="author" content="Diego Borghgraef" /><meta property="og:locale" content="en_US" /><meta name="description" content="I use this website as a personal portfolio of all my write ups, experiences, internships i did. I will also keep a section for my passions for drones &amp; adventures0" /><meta property="og:description" content="I use this website as a personal portfolio of all my write ups, experiences, internships i did. I will also keep a section for my passions for drones &amp; adventures0" /><link rel="canonical" href="https://huskyftw.github.io/posts/Juice-Shop/" /><meta property="og:url" content="https://huskyftw.github.io/posts/Juice-Shop/" /><meta property="og:site_name" content="HuskySEC" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-09T06:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Juice Shop Challenges" /><meta name="twitter:site" content="@Hoosky_SEC" /><meta name="twitter:creator" content="@Diego Borghgraef" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Diego Borghgraef"},"dateModified":"2021-06-09T12:57:52+02:00","datePublished":"2021-06-09T06:00:00+02:00","description":"I use this website as a personal portfolio of all my write ups, experiences, internships i did. I will also keep a section for my passions for drones &amp; adventures0","headline":"Juice Shop Challenges","mainEntityOfPage":{"@type":"WebPage","@id":"https://huskyftw.github.io/posts/Juice-Shop/"},"url":"https://huskyftw.github.io/posts/Juice-Shop/"}</script><title>Juice Shop Challenges | HuskySEC</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="HuskySEC"><meta name="application-name" content="HuskySEC"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://raw.githubusercontent.com/HuskyFTW/HuskyFTW.github.io/master/test.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">HuskySEC</a></div><div class="site-subtitle font-italic">My journey as an Ethical Hacker</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-user-astronaut ml-xl-3 mr-xl-3 unloaded"></i> <span>FINDINGS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw far fa-folder-open ml-xl-3 mr-xl-3 unloaded"></i> <span>RESOURCES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-campground ml-xl-3 mr-xl-3 unloaded"></i> <span>PASSION</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/HuskyFTW" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/Hoosky_SEC" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['Diego.Borghgraef','hotmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Juice Shop Challenges</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Juice Shop Challenges</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Diego Borghgraef </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 9, 2021, 6:00 AM +0200" prep="on" > Jun 9, 2021 <i class="unloaded">2021-06-09T06:00:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 9, 2021, 12:57 PM +0200" prefix="Updated " > Jun 9, 2021 <i class="unloaded">2021-06-09T12:57:52+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1967 words">10 min</span></div></div><div class="post-content"><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121337727-1fd1a680-c91d-11eb-90ef-8d336b61daa4.png" alt="image" /></p><h2 id="owasp-juice-shop">OWASP Juice Shop</h2><p>Insecure web application used as security training/ guinea pig for security tools.</p><h3 id="setup">Setup</h3><p>I installed the Insecure web application on Heroku. It was the quickest and easiest way to set it up. I followed this installation <a href="https://bkimminich.gitbooks.io/pwning-owasp-juice-shop/content/part1/running.html">guide</a>. Link to Heroku OWASP Juice shop app: https://owasp-juice-shop-diego.herokuapp.com/#/</p><h2 id="challenges-">Challenges ★</h2><h3 id="21-bonus-payload-">2.1 Bonus Payload ★</h3><p>```&lt;iframe width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/771984076&amp;col-or=%23ff5500&amp;auto_play=true&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;show_teaser=true"&gt;&lt;/iframe&gt;</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>
### 2.2	Bully Chatbot – Coupon Code ★

### 2.3	Confidential Document – Sensitive Data Exposure ★

### 2.4	DOM XSS – Embedded a malicious script in the search function ★
```&lt;script&gt;alert(xss)&lt;/script&gt;&lt;br/&gt;
&lt;iframe src="javascript:alert(`xss`)"&gt;
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121338666-ffeeb280-c91d-11eb-869f-cb01cc4b6a0a.png" alt="image" /></p><h3 id="25-error-handling-">2.5 Error Handling ★</h3><h3 id="26-exposed-metrics--prometheus-">2.6 Exposed Metrics – Prometheus ★</h3><ul><li>Used to represent the number of requests serverd, tasks completed or errors.<li>https://owasp-juice-shop-diego.herokuapp.com/metrics<li>You can find all the metrics and how many time they occur.</ul><h3 id="27-missing-encoding--improper-input-validation-">2.7 Missing Encoding – Improper Input Validation ★</h3><ul><li>src=”assets/public/images/uploads/😼-#zatschi-#whoneedsfourlegs-1572600969477.jpg”<li>The # is interpreted as HTML Anchors which is why the picture is not working.<li>We have the change with the right encoding<li>Change with %23 which the right encoding</ul><h3 id="28-outdated-allowlist--redirect-to-crypto-currency-address-">2.8 Outdated Allowlist – Redirect to crypto currency address ★</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121339101-6f64a200-c91e-11eb-8450-5b7b1efdfc4b.png" alt="image" /></p><ul><li>Look in F12 (Developer Tools) at main.js files. They contain potential valuable information<li>When looking for redirects we can find Crypto wallets redirects.</ul><h3 id="29-privacy-policy-">2.9 Privacy Policy ★</h3><h3 id="210-repetitive-registration--improper-input-validation-">2.10 Repetitive Registration – Improper Input Validation ★</h3><ul><li>False input in the Registration form<li>You can modify the first set of password and the registration will still be done.<li>After analyzing the last password is the password being used.</ul><h3 id="211-score-board-">2.11 Score Board ★</h3><h3 id="212--zero-stars--burp-suite-tamper-data-">2.12 Zero Stars – Burp Suite Tamper data ★</h3><ul><li>Intercept request from contact from<li>Change values to 0 stars</ul><h2 id="challenges--1">Challenges ★★</h2><h3 id="213-depreciated-interface--security-misconfiguration-">2.13 Depreciated Interface – Security Misconfiguration ★★</h3><ul><li>Using Burp intercept the request for a complain. Only allowed files are pdf &amp; zip.<li>But when using Burp we can change our file type back to XML file.<li>Security Misconfiguration. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121339504-d97d4700-c91e-11eb-97cc-c3b5a8b9c9af.png" alt="image" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121339519-dc783780-c91e-11eb-9d74-15f335be1c33.png" alt="image" /></ul><h3 id="214--login-admin-">2.14 Login Admin ★★</h3><ul><li>‘—</ul><h3 id="215-login-mc-safesearch-">2.15 Login MC SafeSearch ★★</h3><ul><li>mc.safesearch@juice-sh.op<li>Find his password listening to his song<li>Email found true the admin account /administration</ul><h3 id="216-meta-geo-stalking--sensitive-data-exposure-">2.16 Meta Geo Stalking – Sensitive Data Exposure ★★</h3><ul><li>With the use of Exiftools we can extract the coordinates of a picture.<li>Using this we got multiple different places.<li>Using Burp Suite we tried the multiple possibilities until we managed to change the password. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121339701-09c4e580-c91f-11eb-989d-94c07afe7b63.png" alt="image" /></ul><h3 id="217-password-strength--broken-authentication-">2.17 Password Strength – Broken Authentication ★★</h3><ul><li>admin@juice-sh.op:admin123</ul><h3 id="218-sql-injection--access-admin-login-">2.18 SQL Injection – Access Admin Login ★★</h3><ul><li>‘ OR true<li>Check console logs for error messages.</ul><h3 id="219-horizontal-privilege-escalation--broken-access-contol-">2.19 Horizontal Privilege escalation – Broken Access Contol ★★</h3><ul><li>Basket – Add products.<li>F12 Developer tools<li>“Application” – SessionStorage<li>Change “bid” value – Gives you information about other people’s basket.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121339930-4a246380-c91f-11eb-89bd-ee2a73500ab4.png" alt="image" /></p><h3 id="220-security-policy-">2.20 Security Policy ★★</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121339978-56a8bc00-c91f-11eb-876a-0da679d1b21e.png" alt="image" /></p><ul><li>You can find Security Policies by looking at the security.txt file. Most of the time you can find it at /.well-known/security.txt</ul><h3 id="221-visual-geo-stalking--sensitive-data-exposure-">2.21 Visual Geo Stalking – Sensitive Data Exposure ★★</h3><h3 id="222-visual-geo-staking--sensitive-data-exposure-">2.22 Visual Geo Staking – Sensitive Data Exposure ★★</h3><h3 id="223-weird-crypto--cryptographic-issues-">2.23 Weird Crypto – Cryptographic Issues ★★</h3><ul><li>Contact support for bad hash algorithm.<li>MD5 not secure</ul><h2 id="challenges--2">Challenges ★★★</h2><h3 id="224-admin-registration--improper-input-validation-">2.24 Admin Registration – Improper Input Validation ★★★</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121340094-7c35c580-c91f-11eb-9a3d-b1e5ada39be3.png" alt="image" /></p><ul><li>Using Burp Suite Intercept an Registration form<li>Find the /api/Users<li>You find all the information about a users registration<li>When look at the response you see there is a role option<li>By default its set to “customer”<li>When we a repeater attack we can modify the Request to add a role of Admin<li>When sending the requests we get a new user with admin roles.</ul><h3 id="225-forged-feedback--broken-access-control-">2.25 Forged Feedback – Broken Access Control ★★★</h3><ul><li>Customer Feedback<li>Find hidden form<li>Change default value 49 -&gt; 1<li>Message send as Admin</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121340236-a8e9dd00-c91f-11eb-907b-51f77a854041.png" alt="image" /></p><h3 id="226-bjoerns-favorite-pet--broken-authentication-">2.26 Bjoern’s Favorite Pet – Broken Authentication ★★★</h3><ul><li>https://www.youtube.com/watch?v=Lu0-kDdtVf4<li>Looking at this video from Bjoern on the public internet you can see his registration using Bjoern@owasp.org with the security question being Zaya. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121340256-b2734500-c91f-11eb-9bdf-a4f0390a8745.png" alt="image" /></ul><h3 id="227-captcha-bypass--broken-anti-automation-">2.27 CAPTCHA Bypass – Broken Anti Automation ★★★</h3><ul><li>Submit 10 or more customer feedbacks within 10 seconds.<li>Very interesting challenge<li>First I intercepted a request using Burp Suite.<li>I then used in the repeater and found out that the captcha will always be successful with the same CaptchaID en CaptchaCode.<li>Using the Intruder I perfomed 10 attacks which each time different values.<li>CAPTCHA is not secure as it is linked with a certain id.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121340327-c8810580-c91f-11eb-869b-451014833d6c.png" alt="image" /><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121340340-cc148c80-c91f-11eb-8119-a6bc9dbc6a63.png" alt="image" /></p><h3 id="228-csrf--broken-access-control-">2.28 CSRF – Broken Access Control ★★★</h3><ul><li>Cross-Site Request Forgery<li>http://htmledit.squarefree.com/</ul><pre><code class="language-&lt;html&gt;">&lt;body&gt;
&lt;form action="https://owasp-juice-shop-diego.herokuapp.com/profile" method="POST"&gt;
&lt;input type="hidden" name="username" value="tedddt"&gt;
&lt;input type="submit" value="Set Username"&gt;
&lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;

&lt;script&gt;
xmlhttp = XMLHttpRequest;
xmlhttp.open('GET', 'http://owasp-juice-shop-diego.herokuapp.com/rest/user/change-password? new=1234567&amp;repeat=1234567');
xmlhttp.send()
&lt;/script&gt;
</code></pre><h3 id="229-database-schema--injection-difficult-">2.29 Database Schema – Injection (DIFFICULT) ★★★</h3><p><code class="language-plaintext highlighter-rouge">GET /rest/products/search?q=apple'))UNION%20SELECT%20sql,2,3,4,5,6,7,8,9%20FROM%20sqlite_master-- HTTP/1.1 Host: owasp-juice-shop-diego.herokuapp.com Connection: close sec-ch-ua: "Chromium";v="89", ";Not A Brand";v="99" Accept: application/json, text/plain, */* sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Referer: https://owasp-juice-shop-diego.herokuapp.com/ Accept-Encoding: gzip, deflate Accept-Language: nl-NL,nl;q=0.9,en-US;q=0.8,en;q=0.7 </code></p><ul><li>Using burp we find out it is a SQLlite database<li>Using the ‘)) after the search we can start a new query<li>We use the UNION to start a second query<li>%20 is a html character for “space”<li>SELECT sql FROM sqlite_master, gives us a schema of all the different tables on the website. https://www.youtube.com/watch?v=0-D-e66U2Z0</ul><h3 id="230-deluxe-fraud--improper-input-validation-">2.30 Deluxe Fraud – Improper Input Validation ★★★</h3><p>Obtain a Deluxe Membership without paying for it. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341070-97ed9b80-c920-11eb-85e8-c6cfe05d4247.png" alt="image" /></p><ul><li>When unlocking the button for paying through the wallet<li>I get a request with PaymentMode: “wallet”<li>By changing the request in the repeater with “paid” we get a Deluxe Membership.</ul><h3 id="231-forged-feedback--broken-access-control-">2.31 Forged Feedback – Broken Access Control ★★★</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341124-a5a32100-c920-11eb-8ef5-06c3eca685cb.png" alt="image" /></p><ul><li>When inserting the Feedback into Burp, we can see the request being sent.<li>Reading the Response form we see there is a value UserId.<li>By modifying the Request and adding a UserId we can change from who the message is being sent.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341133-a76ce480-c920-11eb-9a3a-2a4c45812482.png" alt="image" /></p><h3 id="232-forged-review--broken-access-control-">2.32 Forged Review – Broken Access Control ★★★</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341174-b18ee300-c920-11eb-89d0-e1481229ecd0.png" alt="image" /></p><ul><li>Same situation as the Forged Feedback.<li>In BurpSuite I changed the “author” with my email address.</ul><h3 id="233-gdpr-data-erasure--broken-authentication-">2.33 GDPR Data Erasure – Broken Authentication ★★★</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341202-b9e71e00-c920-11eb-8572-83029f2a1b07.png" alt="image" /></p><ul><li>Right for erasure with each user.<li>But when performing SQL injection we can connect on someone account and perform a data eras-ure</ul><h3 id="234-login-jim--sql-injection-">2.34 Login Jim – SQL Injection ★★★</h3><ul><li>Jim@juice-sh.op ‘—<li>Avoids putting the login password <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341258-c5d2e000-c920-11eb-8354-7fa240caa3f5.png" alt="image" /></ul><h3 id="235-login-bender--sql-injection-">2.35 Login Bender – SQL Injection ★★★</h3><ul><li>Bender@juice-sh.op ‘— <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341293-cec3b180-c920-11eb-8b0b-b830a50fec48.png" alt="image" /></ul><h3 id="236-login-amy--sensitive-data-exposure-">2.36 Login Amy – Sensitive Data Exposure ★★★</h3><ul><li>Looking at the link: https://www.grc.com/haystack.htm<li>We find information about possible good passwords<li>With the knowledge from the tutorial we know amy has a boyfriend named kif<li>D0g………………… –&gt; K1f…………………</ul><h3 id="237-manipulate-basket--broken-access-control-">2.37 Manipulate Basket – Broken Access Control ★★★</h3><p>When adding product to your basket you can added BasketIds from other persons. This gives the possibility to checkout with multiple baskets.</p><h3 id="238-payback-time--improper-input-validation-">2.38 Payback Time – Improper Input Validation ★★★</h3><p>When adding a product to your basket you get a request for the quantity. You can change the quantity to a negative number, which gives you the possibility to have -100 in quantity. When ordering the products you actually get money back ! <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341363-e13deb00-c920-11eb-8838-e9ff3ffff89a.png" alt="image" /></p><h3 id="239-privacy-policy-inspection--security-through-obscurity-">2.39 Privacy Policy Inspection – Security Through Obscurity ★★★</h3><h3 id="240-product-tampering--broken-access-control-">2.40 Product Tampering – Broken Access Control ★★★</h3><p>When looking at the review page of a product, you get information about it. Changing the request to a PUT request on the API and only change the description information. So that when you click on the more button the href changed to owasp.slack.</p><h3 id="241-reset-jims-password--broken-authentication-">2.41 Reset Jim’s Password – Broken Authentication ★★★</h3><p>Reference to Startrek.</p><h3 id="242-upload-size--improper-input-validation-">2.42 Upload Size – Improper Input Validation ★★★</h3><p>Change the data inserted in the request with a file higher than 100kb. This gives us the possibility to upload bigger files. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341410-ec911680-c920-11eb-86e4-3ed04d83d235.png" alt="image" /></p><h3 id="243-upload-type--improper-input-validation-">2.43 Upload Type – Improper Input Validation ★★★</h3><p>For the upload type, I uploaded the file using the .exe.pdf extension, so it accepts the file on request. After setting it up in the repeater I removed the .pdf so that the .exe could be executed.</p><p>## Challenges ★★★★</p><h3 id="244--access-log--sensitive-data-exposure-">2.44 Access Log – Sensitive Data Exposure ★★★★</h3><p>https://owasp-juice-shop-diego.herokuapp.com/support/logs</p><h3 id="245-allowlist-bypass--unvalidated-redirects-">2.45 Allowlist Bypass – Unvalidated Redirects ★★★★</h3><p>https://owasp-juice-shop-die-go.herokuapp.com/redirect?to=diegoborghgraef.be?pwnd=https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm</p><h3 id="246-christmas-special--injection-">2.46 Christmas Special – Injection ★★★★</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341528-0c283f00-c921-11eb-96f6-42f43cab8089.png" alt="image" /></p><p>First I createda SQL Injection using the known ‘))—request which gives me information about all the prod-ucts in the shop. We found out that the Christmas Special is id 10. With this information we created a new request when adding a product in the cart but changed the ProductId with the id 10. When added in the bas-ket we ordered the product using the – quantity exploit which gave us a free order. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341544-0fbbc600-c921-11eb-8f9c-cbf1f86d6464.png" alt="image" /></p><h3 id="247-easter-egg--broken-access-control-">2.47 Easter Egg – Broken Access Control ★★★★</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341584-18140100-c921-11eb-834c-bb3854e37214.png" alt="image" /> https://owasp-juice-shop-diego.herokuapp.com/ftp/eastere.gg%2500.md</p><p>We can find a lot of files in the ftp folder, but the problem is that we are only allowed to download .md &amp; .pdf files. When modifying the request URL we added some HTML encode %25 and then added .md Now the file is available to download. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341615-1e09e200-c921-11eb-82ce-2faaf5bd3704.png" alt="image" /> NULL BYTE INJECTION (%00)</p><h3 id="248-ephemeral-accountant--injection-">2.48 Ephemeral Accountant – Injection ★★★★</h3><h3 id="249-expired-coupon--improper-input-validation-">2.49 Expired Coupon – Improper Input Validation ★★★★</h3><p>When looking at the JavaScript file you can find information about all the available coupons. The problem is that they are not working anymore. Because they were only available for 1 day. When changing our Operat-ing systems time to the right date and apply the coupon we can see it working. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341662-29f5a400-c921-11eb-8ae7-d781d290f4d8.png" alt="image" /></p><h3 id="250-forgotten-developer-backup--sensitive-data-exposure-">2.50 Forgotten Developer Backup – Sensitive Data Exposure ★★★★</h3><p>https://owasp-juice-shop-diego.herokuapp.com/ftp/package.json.bak%2500.md</p><h3 id="251-forgotten-salesman-backup--sensitive-data-exposure-">2.51 Forgotten Salesman Backup – Sensitive Data Exposure ★★★★</h3><p>http://localhost:3000/ftp/coupons_2013.md.bak%2500.md</p><h3 id="252-gdpr-data-theft--sensitive-data-exposure-">2.52 GDPR Data Theft – Sensitive Data Exposure ★★★★</h3><h3 id="253-leaked-unsafe-product--sensitive-data-exposure-">2.53 Leaked Unsafe Product – Sensitive Data Exposure ★★★★</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341888-632e1400-c921-11eb-9cf0-75c253aee713.png" alt="image" /></p><h3 id="254-legacy-typosquatting--sensitive-data-exposure-">2.54 Legacy Typosquatting – Sensitive Data Exposure ★★★★</h3><p>Typosquatting is een vorm van misbruik van het internet gebaseerd op het feit dat mensen zich weleens vergissen bij het intypen van een websiteadres. De typosquatter zet een website op, waarvan het adres (domeinnaam) slechts heel weinig verschilt van het adres van een populaire website. Alle internetgebrui-kers die dezelfde typefout of vergissing maken, komen terecht op de website van de typosquatter. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121341908-69bc8b80-c921-11eb-83b4-d400ab69aabc.png" alt="image" /></p><p>In the Developers backup file you find alle the dependencies used on the OWASP JuiceShop. 1 depency was not the right one. Epilogue-js is not the real epilogue. This is due to someone typosquatting.</p><h3 id="255-login-bjoern--broken-authentication-">2.55 Login Bjoern – Broken Authentication ★★★★</h3><h3 id="256-misplaced-signature-file--sensitive-data-exposure-">2.56 Misplaced Signature File – Sensitive Data Exposure ★★★★</h3><p>Sigma is a generic and open signature format that allows you to describe relevant log events in a straight-forward manner. The rule format is very flexible, easy to write and applicable to any type of log file. The main purpose of this project is to provide a structured form in which researchers or analysts can describe their once developed detection methods and make them shareable with others.</p><p>SIEM SIGNATURE.  ACCESS .YML FILE : https://owasp-juice-shop-diego.herokuapp.com/ftp/suspicious_errors.yml%2500.md</p><h3 id="257-nested-easter-egg--cryptographic-issues-">2.57 Nested Easter Egg – Cryptographic Issues ★★★★</h3><p>L2d1ci9xcmlmL25lci9mYi9zaGFhbC9ndXJsL3V2cS9uYS9ybmZncmUvcnR0L2p2Z3V2YS9ndXIvcm5mZ3JlL3J0dA== (Code found in the FTP folder)</p><p>When decoding it in Base 64. You get a path. But the words do not mean anything. Using a online decipher tool. We found a matching deciphering technique that gave us the path we wanted.</p><p>https://owasp-juice-shop-diego.herokuapp.com/the/devs/are/so/funny/they/hid/an/easter/egg/within/the/easter/egg</p><h3 id="258-nosql-manipulation--injection-">2.58 NoSQL Manipulation – Injection ★★★★</h3><p>https://www.netsparker.com/blog/web-security/what-is-nosql-injection/ Target databases that do not use the sequal database model <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121342007-85c02d00-c921-11eb-9c29-345945bed789.png" alt="image" /></p><h3 id="259-poison-null-byte--improper-input-validation-">2.59 Poison Null Byte – Improper Input Validation ★★★★</h3><p>%2500.md</p><h3 id="260-reset-benders-password--broken-authentication-">2.60 Reset Bender’s Password – Broken Authentication ★★★★</h3><h3 id="261-reset-uvogins-password--sensitive-data-exposure-">2.61 Reset Uvogin’s Password – Sensitive Data Exposure ★★★★</h3><h3 id="262-steganography--security-through-obscurity-">2.62 Steganography – Security Through Obscurity ★★★★</h3><p>Steganography, partice of concealing a message within another message or a physical object. In computer file, message, image or video is concealed within another file.</p><p>For this challenge we get a hint that we need to look for the Lorem Ipsum. We know that a Lorem Ipsum text is available on the About Us page. There we can find a slideshow of multiple pictures of users. Be-cause we are working with Steganography is used the Openstego tool to try to read each picture. Some-thing I didn’t know is that 1 image had a .png format and there we found a steganography.</p><p>It was a Image of Pickle Rick! We then sended a Customer Feedback with Pickle Rick to get the challenge done. <br /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/46396750/121342082-996b9380-c921-11eb-9c9d-f967c0c63577.png" alt="image" /></p><h3 id="more-coming-soon">MORE COMING SOON</h3><p> </p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/security/'>Security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/challenges/" class="post-tag no-text-decoration" >challenges</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Juice Shop Challenges - HuskySEC&url=https://huskyftw.github.io/posts/Juice-Shop/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Juice Shop Challenges - HuskySEC&u=https://huskyftw.github.io/posts/Juice-Shop/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Juice Shop Challenges - HuskySEC&url=https://huskyftw.github.io/posts/Juice-Shop/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/text-and-typography/">Text and Typography</a><li><a href="/posts/enable-google-pv/">Enable Google Page Views</a><li><a href="/posts/write-a-new-post/">Writing a New Post</a><li><a href="/posts/Jekyll-website/">Jekyll website</a><li><a href="/posts/Sauna-HTB/">Sauna Website</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/challenges/">challenges</a> <a class="post-tag" href="/tags/google-analytics/">google analytics</a> <a class="post-tag" href="/tags/pageviews/">pageviews</a> <a class="post-tag" href="/tags/typography/">typography</a> <a class="post-tag" href="/tags/writing/">writing</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Sauna-HTB/"><div class="card-body"> <span class="timeago small" > May 19 <i class="unloaded">2023-05-19T04:40:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Sauna Website</h3><div class="text-muted small"><p> Sauna - HackTheBox Write up of Sauna - Hack The Box Reconnaissance First, we need to scan the target with Nmap. The following command will scan the target IP address (10.10.10.175) and output th...</p></div></div></a></div><div class="card"> <a href="/posts/write-a-new-post/"><div class="card-body"> <span class="timeago small" > Aug 8, 1970 <i class="unloaded">1970-08-08T07:10:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing a New Post</h3><div class="text-muted small"><p> Naming and Path Create a new file named YYYY-MM-DD-TITLE.EXTENSION and put it in the _posts/ of the root directory. Please note that the EXTENSION must be one of md and markdown. Front Matter Ba...</p></div></div></a></div><div class="card"> <a href="/posts/text-and-typography/"><div class="card-body"> <span class="timeago small" > Aug 8, 1970 <i class="unloaded">1970-08-08T04:33:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Text and Typography</h3><div class="text-muted small"><p> This post is to show Markdown syntax rendering on Chirpy, you can also use it as an example of writing. Now, let’s start looking at text and typography. Titles H1 - heading H2 - heading H3 - h...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/write-a-new-post/" class="btn btn-outline-primary" prompt="Older"><p>Writing a New Post</p></a> <a href="/posts/Sauna-HTB/" class="btn btn-outline-primary" prompt="Newer"><p>Sauna Website</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/Hoosky_SEC">Diego Borghgraef</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/challenges/">challenges</a> <a class="post-tag" href="/tags/google-analytics/">google analytics</a> <a class="post-tag" href="/tags/pageviews/">pageviews</a> <a class="post-tag" href="/tags/typography/">typography</a> <a class="post-tag" href="/tags/writing/">writing</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://HuskyFTW.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
